局部变量 { .text-center }
-------

&nbsp;

### 局部变量赋值、改值

上一节介绍了修改 VM 中变量的 3 条规则，这 3 条规则对全局变量适用，对局部变量也适用。但，解释器是如何区分全局变量，还是局部变量的呢？解释器只需分析被操作的变量是否在全局空间存在，就能判断当前操作的变量是全局的，还是局部的。凡在全局空间找不到定义，解释器均自动视之为局部变量。

局部变量仅在当次触发期间生效，典型情况比如，一次提问，由预定义的触发词触发，然后解释器动态生成局部变量空间，在一次触发的处理过程中使用局部变量，处理结束时，局部变量空间将自动销毁。

&nbsp;

### 自动局部变量

VM 解释器由 room 定义（即 `room_cfg`）决定是否自动生成如下局部变量：

1. 如果定义 `room_cfg.reuse_last_ask` 为 True，系统将自动添加 LASK_ASK 局部变量，自动把最后一次提问的字串值赋给它。这个变量适用于构造相同查询，比方定义 `"继续"` 触发词，每次触发都将最近一次问过的问题再提交一次，这在查询天气、股票、汇率行情等周期性反复使用的场合比较有用，结合 `"，"` 快捷输入（单独输入一个逗号，公众号后台会自动将它转成 `"继续"`）用起来很轻便。

2. 如果定义 `room_cfg.check_chinese` 为 True，系统将自动识别当前问话是否为中文，并自动赋 True 或 False 给 `IS_CN` 局部变量。这变量有助构造中英文两套 prompt，依据提问自动适配，如果用中文提问，上下文提示是中文，若是英文，上下文宜改用英文。

&nbsp;
